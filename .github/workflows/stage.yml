name: Weekly Auto PR from Dev to Staging

on:
  # schedule:
  #   - cron: "0 13 * * 5"  # Runs every Friday at 8:00 AM EST (13:00 UTC)
  workflow_dispatch:  # Allows manual trigger if needed

jobs:
  create_pr:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # To allow pushing changes to the repo
      pull-requests: write  # To create and manage pull requests
    steps:
      - name: Checkout the repository
        uses: actions/checkout@v4

      - name: Fetch the remote branches
        run: git fetch origin

      - name: Create Pull Request from origin/dev to origin/staging
        uses: peter-evans/create-pull-request@v6
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          base: staging  # Refers to the remote 'staging' branch
          branch: main    # Refers to the remote 'dev' branch
          title: "Weekly Auto PR: Merge origin/dev into origin/staging"
          body: "This PR was auto-generated by GitHub Actions (scheduled weekly)."
          commit-message: "Automated PR for weekly merge from origin/dev to origin/staging"
